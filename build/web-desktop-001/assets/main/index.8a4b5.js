System.register("chunks:///_virtual/ItemType.ts",["cc"],(function(e){"use strict";var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){var o;t._RF.push({},"00d62EDjh9E3q3UdJ3D0yF6","ItemType",void 0),function(e){e[e.None=0]="None",e[e.Flower1=1]="Flower1",e[e.Flower2=2]="Flower2",e[e.BonusBox=3]="BonusBox"}(o||(o={}));e("default",o);t._RF.pop()}}}));

System.register("chunks:///_virtual/InputType.ts",["cc"],(function(e){"use strict";var n;return{setters:[function(e){n=e.cclegacy}],execute:function(){var t;n._RF.push({},"74deaK1zCtBLoO9WV0EKQXe","InputType",void 0),function(e){e[e.None=0]="None",e[e.Down=1]="Down",e[e.Move=2]="Move",e[e.Up=3]="Up",e[e.Cancel=4]="Cancel"}(t||(t={}));e("default",t);n._RF.pop()}}}));

System.register("chunks:///_virtual/Events.ts",["cc"],(function(e){"use strict";var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){var n;t._RF.push({},"910660i/8dMq6XP6HEejuWS","Events",void 0),function(e){e.ItemChosen="item_chosen",e.ItemDropped="item_dropped",e.ItemSet="item_set",e.INPUT="input"}(n||(n={}));e("default",n);t._RF.pop()}}}));

System.register("chunks:///_virtual/FieldWatcher.ts",["cc","./ItemType.ts","./Events.ts","./_rollupPluginModLoBabelHelpers.js","./Item.ts"],(function(e){"use strict";var t,i,n,r,l,o,s,a,h,u,f,d,p,c,m,y,g,b,F;return{setters:[function(e){t=e.cclegacy,i=e._decorator,n=e.SpriteFrame,r=e.Node,l=e.Prefab,o=e.Enum,s=e.director,a=e.Vec2,h=e.instantiate,u=e.Sprite,f=e.Component},function(e){d=e.default},function(e){p=e.default},function(e){c=e.applyDecoratedDescriptor,m=e.inheritsLoose,y=e.initializerDefineProperty,g=e.assertThisInitialized,b=e.defineProperty},function(e){F=e.Item}],execute:function(){var v,C,_,I,w,x,A,P,S,M,N,z,k;t._RF.push({},"bbd0a3a4HhBT6uQk0Ek0fKE","FieldWatcher",void 0);var q=i.ccclass,D=i.property;e("FieldWatcher",(v=q("FieldWatcher"),C=D(n),_=D(r),I=D(l),w=D({type:o(d)}),v((P=c((A=function(e){function t(){for(var t,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return t=e.call.apply(e,[this].concat(n))||this,y(g(t),"lengthField",P,g(t)),y(g(t),"heightField",S,g(t)),y(g(t),"spriteCell",M,g(t)),y(g(t),"inputCatcher",N,g(t)),y(g(t),"itemPrefab",z,g(t)),y(g(t),"initialItems",k,g(t)),b(g(t),"_sideSquare",0),b(g(t),"_fieldArray",[]),t}m(t,e);var i=t.prototype;return i.onLoad=function(){this.makeCells(),this.makeItems(),this.inputCatcher.active=!1},i.onEnable=function(){this.handleSubscription(!0)},i.onDisable=function(){this.handleSubscription(!1)},i.handleSubscription=function(e){var t=e?"on":"off";s[t](p.ItemChosen,this.onItemChosen,this),s[t](p.ItemDropped,this.onItemDropped,this)},i.onItemDropped=function(e){var t=this.defineCell(e.getPosition()),i=this.node.getChildByName("h"+t.y+"l"+t.x).position;s.emit(p.ItemSet,i),this.fusionItems(e,t)},i.defineNumbers=function(e){for(var t=0;t<this.heightField;t++){var i=this._fieldArray[t].indexOf(e);if(-1!==i)return new a(i,t)}},i.onItemChosen=function(){this.inputCatcher.active=!0},i.defineCellPosition=function(e){return this.node.getChildByName("h"+e.y+"l"+e.x).position},i.defineCell=function(e){var t=Math.floor(e.x/this._sideSquare+this.lengthField/2-1)+1,i=Math.floor(e.y/this._sideSquare+this.heightField/2-1)+1;return new a(t,i)},i.makeItems=function(){for(var e=this.initialItems.length,t=0;t<e;t++){var i=h(this.itemPrefab),n=i.getComponent(F);n.type=this.initialItems[t],n.setType(n.type);var r=this.chooseNumbers(),l=this.node.getChildByName("h0l0").position;n.deltaX=-l.x,n.deltaY=-l.y,i.setParent(this.node);var o=this.node.getChildByName("h"+r.y+"l"+r.x);i.setPosition(o.position),this._fieldArray[r.y][r.x]=i}},i.makeCells=function(){if(this._sideSquare=this.spriteCell.height,this.lengthField&&this.heightField&&this.spriteCell)for(var e=0;e<this.heightField;e++){this._fieldArray[e]=[];for(var t=0;t<this.lengthField;t++){this._fieldArray[e][t]=null;var i=new r("h"+e+"l"+t);i.addComponent(u).spriteFrame=this.spriteCell,i.setParent(this.node),i.position.set((t-this.lengthField/2+.5)*this._sideSquare,(e-this.heightField/2+.5)*this._sideSquare)}}},i.fusionItems=function(e,t){var i=this._fieldArray[t.y][t.x];if(i!==e){var n=e,r=this.defineNumbers(e);if(i){var l=i.getComponent(F),o=null==e?void 0:e.getComponent(F);if(l.type===o.type)l.dropItem(),o.transformationItem(l.type+1);else{var s=t;t=this.findFreeCell(t,e),l.transferItem(this.defineCellPosition(t)),this._fieldArray[s.y][s.x]=n,n=i}}this._fieldArray[r.y][r.x]=null,this._fieldArray[t.y][t.x]=n}},i.chooseNumbers=function(){for(var e=new a(0,0);null!==this._fieldArray[e.y][e.x];)e=new a(Math.floor(Math.random()*this.lengthField),Math.floor(Math.random()*this.heightField));return e},i.findFreeCell=function(e,t){for(var i=new a(this.lengthField*this.heightField,0),n=this.heightField*this.lengthField,r=0;r<this.heightField;r++)for(var l=0;l<this.lengthField;l++)if(!this._fieldArray[r][l]||this._fieldArray[r][l]===t){var o=Math.sqrt(Math.pow(e.y-r,2)+Math.pow(e.x-l,2));o<n&&(n=o,i=new a(l,r))}return i},t}(f)).prototype,"lengthField",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),S=c(A.prototype,"heightField",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),M=c(A.prototype,"spriteCell",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=c(A.prototype,"inputCatcher",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),z=c(A.prototype,"itemPrefab",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=c(A.prototype,"initialItems",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return d.Flower1}}),x=A))||x));t._RF.pop()}}}));

System.register("chunks:///_virtual/InputCatcher.ts",["cc","./InputType.ts","./Events.ts","./_rollupPluginModLoBabelHelpers.js"],(function(t){"use strict";var n,e,o,i,s,u,c,r;return{setters:[function(t){n=t.cclegacy,e=t._decorator,o=t.Node,i=t.director,s=t.Component},function(t){u=t.default},function(t){c=t.default},function(t){r=t.inheritsLoose}],execute:function(){var p;n._RF.push({},"d55cdQHxk9L3ZlpZ7dMWYnQ","InputCatcher",void 0);var a=e.ccclass;t("InputCatcher",a("InputCatcher")(p=function(t){function n(){return t.apply(this,arguments)||this}r(n,t);var e=n.prototype;return e.onEnable=function(){this.handleSubscription(!0)},e.onDisable=function(){this.handleSubscription(!1)},e.handleSubscription=function(t){var n=t?"on":"off";this.node[n](o.EventType.MOUSE_MOVE,this.onMouseMove,this),this.node[n](o.EventType.MOUSE_UP,this.onMouseUp,this)},e.onMouseMove=function(t){i.emit(c.INPUT,u.Move,t,this)},e.onMouseUp=function(t){i.emit(c.INPUT,u.Up,t,this),this.node.active=!1},n}(s))||p);n._RF.pop()}}}));

System.register("chunks:///_virtual/Item.ts",["cc","./ItemType.ts","./InputType.ts","./Events.ts","./_rollupPluginModLoBabelHelpers.js"],(function(t){"use strict";var e,i,n,o,s,r,a,c,h,u,l,p,d,f,g;return{setters:[function(t){e=t.cclegacy,i=t._decorator,n=t.Node,o=t.director,s=t.Vec3,r=t.Animation,a=t.Component},function(t){c=t.default},function(t){h=t.default},function(t){u=t.default},function(t){l=t.applyDecoratedDescriptor,p=t.inheritsLoose,d=t.initializerDefineProperty,f=t.assertThisInitialized,g=t.defineProperty}],execute:function(){var m,y,I,v,D,b;e._RF.push({},"f2135aoczNOuY27AmEZZ+tb","Item",void 0);var _=i.ccclass,S=i.property;t("Item",(m=_("Item"),y=S(n),m((D=l((v=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),o=0;o<i;o++)n[o]=arguments[o];return e=t.call.apply(t,[this].concat(n))||this,d(f(e),"shine",D,f(e)),d(f(e),"type",b,f(e)),g(f(e),"_isDragging",!1),g(f(e),"_stopDragging",!1),g(f(e),"deltaX",0),g(f(e),"deltaY",0),e}p(e,t);var i=e.prototype;return i.onEnable=function(){this.handleSubscription(!0)},i.onDisable=function(){this.handleSubscription(!1)},i.handleSubscription=function(t){var e=t?"on":"off";this.node[e](n.EventType.TOUCH_START,this.onDown,this),o[e](u.INPUT,this.onInput,this)},i.onInput=function(t,e){if(this._isDragging&&!this._stopDragging)switch(t){case h.Move:var i=new s(e.getDeltaX(),e.getDeltaY(),0),n=this.node.position.clone().add(i);if(n.x<-this.deltaX||n.x>this.deltaX||n.y<-this.deltaY||n.y>this.deltaY)return;this.node.setPosition(n.x,n.y,0);break;case h.Up:o.on(u.ItemSet,this.onItemSet,this),o.emit(u.ItemDropped,this.node,this.type),this._isDragging=!1}},i.onDown=function(){this._stopDragging||(this._isDragging=!0,o.emit(u.ItemChosen),this.node.setSiblingIndex(1e3))},i.onItemSet=function(t){this.node.setPosition(t),o.off(u.ItemSet,this.onItemSet,this)},i.setType=function(t){this.node.children[t].active=!0},i.dropItem=function(){this.handleSubscription(!1),this.node.destroy()},i.transformationItem=function(t){var e=this;this._stopDragging=!0,this.node.children[this.type].active=!1,this.shine.active=!0,this.shine.getComponent(r).play(),this.scheduleOnce((function(){e.shine.active=!1,e.node.children[t].active=!0,e.type=t,e._stopDragging=!1}),1)},i.transferItem=function(t){this.node.setPosition(t)},e}(a)).prototype,"shine",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=l(v.prototype,"type",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return c.Flower1}}),I=v))||I));e._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./ItemType.ts","./InputType.ts","./Events.ts","./Item.ts","./FieldWatcher.ts","./InputCatcher.ts"],(function(){"use strict";return{setters:[null,null,null,null,null,null],execute:function(){}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});